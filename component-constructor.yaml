# yaml-language-server: $schema=https://ocm.software/schemas/configuration-schema.yaml

components:
  - name: github.com/openmcp-project/openmcp
    labels:
    - name: "org.opencontainers.image.source"
      value: "https://github.com/openmcp-project/openmcp"
    version: "${OPENMCP_VERSION}"
    provider:
      name: openmcp-project
    componentReferences:
      - componentName: github.com/openmcp-project/mcp-operator
        name: mcp-operator
        version: ${MCP_OPERATOR_VERSION}
      
      - componentName: github.com/openmcp-project/openmcp-operator
        name: openmcp-operator
        version: ${OPENMCP_OPERATOR_VERSION}

      - componentName: github.com/openmcp-project/gitops-templates
        name: gitops-templates
        version: ${GITOPS_TEMPLATES_VERSION}

      - componentName: github.com/openmcp-project/control-plane-operator
        name: control-plane-operator
        version: ${CONTROL_PLANE_OPERATOR_VERSION}

      - componentName: github.com/openmcp-project/quota-operator
        name: quota-operator
        version: ${QUOTA_OPERATOR_VERSION}

      - componentName: github.com/openmcp-project/project-workspace-operator
        name: project-workspace-operator
        version: ${PROJECT_WORKSPACE_OPERATOR_VERSION}

      - componentName: github.com/openmcp-project/service-provider-landscaper
        name: service-provider-landscaper
        version: ${SERVICE_PROVIDER_LANDSCAPER_VERSION}

      - componentName: github.com/openmcp-project/service-provider-crossplane
        name: service-provider-crossplane
        version: ${SERVICE_PROVIDER_CROSSPLANE_VERSION}

      - componentName: github.com/openmcp-project/cluster-provider-gardener
        name: cluster-provider-gardener
        version: ${CLUSTER_PROVIDER_GARDENER_VERSION}

      - componentName: github.com/openmcp-project/cluster-provider-kind
        name: cluster-provider-kind
        version: ${CLUSTER_PROVIDER_KIND_VERSION}

      - componentName: github.com/openmcp-project/bootstrapper
        name: bootstrapper
        version: ${BOOTSTRAPPER_VERSION}

    resources:
      - name: external-dns-chart
        version: ${EXTERNAL_DNS_VERSION}
        type: helmChart
        access:
          type: helm
          helmChart: external-dns:${EXTERNAL_DNS_VERSION#v}
          helmRepository: https://kubernetes-sigs.github.io/external-dns
      
      - name: external-dns-image
        version: ${EXTERNAL_DNS_VERSION}
        type: ociImage
        input:
          type: ociImage
          path: registry.k8s.io/external-dns/external-dns:${EXTERNAL_DNS_VERSION}
          repository: images/external-dns

      - name: fluxcd-source-controller
        version: ${FLUXCD_SOURCE_CONTROLLER_VERSION}
        type: ociImage
        input:
          type: ociImage
          path: ghcr.io/fluxcd/source-controller:${FLUXCD_SOURCE_CONTROLLER_VERSION}
          repository: images/fluxcd/source-controller

      - name: fluxcd-kustomize-controller
        version: ${FLUXCD_KUSTOMIZE_CONTROLLER_VERSION}
        type: ociImage
        input:
          type: ociImage
          path: ghcr.io/fluxcd/kustomize-controller:${FLUXCD_KUSTOMIZE_CONTROLLER_VERSION}
          repository: images/fluxcd/kustomize-controller

      - name: fluxcd-helm-controller
        version: ${FLUXCD_HELM_CONTROLLER_VERSION}
        type: ociImage
        input:
          type: ociImage
          path: ghcr.io/fluxcd/helm-controller:${FLUXCD_HELM_CONTROLLER_VERSION}
          repository: images/fluxcd/helm-controller

      - name: fluxcd-notification-controller
        version: ${FLUXCD_NOTIFICATION_CONTROLLER_VERSION}
        type: ociImage
        input:
          type: ociImage
          path: ghcr.io/fluxcd/notification-controller:${FLUXCD_NOTIFICATION_CONTROLLER_VERSION}
          repository: images/fluxcd/notification-controller

      - name: fluxcd-image-reflector-controller
        version: ${FLUXCD_IMAGE_REFLECTOR_CONTROLLER_VERSION}
        type: ociImage
        input:
          type: ociImage
          path: ghcr.io/fluxcd/image-reflector-controller:${FLUXCD_IMAGE_REFLECTOR_CONTROLLER_VERSION}
          repository: images/fluxcd/image-reflector-controller

      - name: fluxcd-image-automation-controller
        version: ${FLUXCD_IMAGE_AUTOMATION_CONTROLLER_VERSION}
        type: ociImage
        input:
          type: ociImage
          path: ghcr.io/fluxcd/image-automation-controller:${FLUXCD_IMAGE_AUTOMATION_CONTROLLER_VERSION}
          repository: images/fluxcd/image-automation-controller

    sources:
      - access:
          ref: "refs/tags/${OPENMCP_VERSION}"
          commit: "${OPENMCP_VERSION_COMMIT}"
          type: gitHub
          repoUrl: https://github.com/openmcp-project/openmcp
        name: openmcp
        type: git
        version: ${OPENMCP_VERSION}
